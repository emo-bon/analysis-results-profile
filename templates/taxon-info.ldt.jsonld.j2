{#- 
Template: otus-species.ldt.jsonld.j2 
Description: Template to generate triples taxonomy-summary data resulting from analysis performed in context of EMOBON.
Input:
    - ./taxonomy-summary/LSU/DBB.merged_LSU.fasta.mseq.tsv
Sets:

Variable: ??
    - file_name ~ the @id of the file in the ro-crate-metadata.json representing the taxonomic information 
-#}

{
    "@context": {
        "@vocab": "https://w3id.org/ro/crate/1.2-DRAFT/context",
        "dcat": "http://www.w3.org/ns/dcat#",
        "dct": "http://purl.org/dc/terms/",
        "pcdm": "http://pcdm.org/models#",
        "skos": "http://www.w3.org/2004/02/skos/core#"
    },
    "@graph": [
        {
            "@id": "{{file_name}}",

            {%- if _.taxonomy %}
            "about": 
                {
                    "@type": "Taxon", 
                    "@id":"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id={{_.taxid}}",
                    {%- set taxonomy_array = _.taxonomy.split(';') %}
                    {% set taxon_item = taxonomy_array[-1] %}
                    {% set taxon_rank_name = taxon_item.split('__') %}
                        {% set taxon_name = taxon_rank_name[-1]%}
                        {% set taxon_rank = taxon_rank_name[-2]%}
                      

                    {%- if taxon_name | length > 0 %}
                    "name": "{{taxon_name}}",
                    "scientificName": "{{taxon_name}}",
                    {%- endif %}

                    {%- if taxon_rank == 'sk' %}
                    "taxonRank": "super kingdom"
                    {%- elif taxon_rank ==  'k' %}
                    "taxonRank": "kingdom"
                    {%- elif taxon_rank ==  'p' %}
                    "taxonRank": "phylum"
                    {%- elif taxon_rank ==  'c' %}
                    "taxonRank": "class"
                    {%- elif taxon_rank ==  'o' %}
                    "taxonRank": "order"
                    {%- elif taxon_rank ==  'f' %}
                    "taxonRank": "famliy"
                    {%- elif taxon_rank ==  'g' %}
                    "taxonRank": "genus"
                    {%- elif taxon_rank ==  's' %}
                    "taxonRank": "species"
                    {%- endif %}
                }
            {%- endif %}
        }
    ]
}


